import sqlite3

def create_database():
    conn = sqlite3.connect('scan_results.db')
    cursor = conn.cursor()

    # Create table
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS scan_results (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            ip TEXT,
            port INTEGER,
            state TEXT,
            service TEXT
        )
    ''')

    conn.commit()
    conn.close()

def save_result(ip, port, state, service):
    conn = sqlite3.connect('scan_results.db')
    cursor = conn.cursor()
    cursor.execute('''
        INSERT INTO scan_results (ip, port, state, service)
        VALUES (?, ?, ?, ?)
    ''', (ip, port, state, service))
    conn.commit()
    conn.close()

def fetch_results():
    conn = sqlite3.connect('scan_results.db')
    cursor = conn.cursor()
    cursor.execute('SELECT * FROM scan_results')
    results = cursor.fetchall()
    conn.close()

    for row in results:
        print(row)

# Initialize database and create table if not exists
create_database()
